---
layout: post
title: OSWP
subtitle: OSWP 자격증 시험 준비를 위한 정리
author: g3rm
categories:
banner:
  image: /assets/images/banners/home.gif
  opacity: 0.618
  background: "#000"
  heading_style: "font-size: 4.25em; font-weight: bold;"
  subheading_style: "color: gold"
tags:
  - OSWP
  - Kali_Linux
  - Wireless
  - Offsec
sidebar:
---
# Info
##  Exam
https://lab.wifichallenge.com/
## Resource
[https://www.offsec.com/courses/pen-210/](https://www.offsec.com/courses/pen-210/)
[https://lab.wifichallenge.com/](https://lab.wifichallenge.com/)
[https://pierrelouis.blog/posts/oswp-lab-setup/](https://pierrelouis.blog/posts/oswp-lab-setup/)
[https://zeyadazima.com/certificates/oswprg/](https://zeyadazima.com/certificates/oswprg/)
[https://youtu.be/Ra0dGPYScLQ?si=KMNJr7d0PbI08b8Y](https://youtu.be/Ra0dGPYScLQ?si=KMNJr7d0PbI08b8Y)

## Setting
https://github.com/r4ulcl/WiFiChallengeLab-docker

```shell
git clone https://github.com/r4ulcl/WiFiChallengeLab-docker
cd WiFiChallengeLab-docker
docker compose --file docker-compose.yml up -d
```

# Basic
## Enum Info
```shell
# 드라이버 확인
sudo airmon-ng

# USB 장치 나열
sudo lsusb -vv

# 종속성, 호환성 및 펌웨어 요구사항 확인
sudo modinfo ath9k_htc

# 로드된 모듈과 각 모듈의 종속성 나열
lsmod

# 모듈 제거 - 종속되어 있는 거 모두 나열
sudo rmmod <module_name1> <module_name2>
```

## Brute Force
```shell
# rockyou 변환
cat ~/rockyou-top100000.txt | awk '{print "wifi-" $1}' > ~/wifi-rockyou.txt


```

## Wireless Tools

### iw util
```shell
# 사용 가능한 채널/주파수 표시
sudo iwlist wlan0 frequency

# 더 자세히 표시
sudo iw list

# 채널 설정
sudo iwconfig wlan0mon channel 11

# 사용 가능한 SSID 나열
sudo iw dev wlan0 scan | grep SSID

# iw 스캔 출력 구문 분석을 통해 사용 가능한 SSID 및 채널 나열
sudo iw dev wlan0 scan | egrep "DS Parameter set|SSID:"

# 새 가상 인터페이스(VIF) wlan0mon를 생성 및 활성화 및 제거
sudo iw dev wlan0 interface add wlan0mon type monitor
sudo ip link set wlan0mon up
sudo iw dev wlan0mon interface del

# 덤프
sudo tcpdump -i wlan0mon

# 규제 확인 country 00
sudo iw reg get

# 규제 도메인 변경 및 설정 / 영구 변경은 /etc/default/crda에서 REGDOMAIN=US 처럼 입력
iw reg set <COUNTRY>
```

### rfkill
_rfkill은_ 연결된 무선 기기를 활성화 또는 비활성화하는 도구
```shell
# 활성화된 모든 Wi-Fi 및 Bluetooth 장치를 표시
sudo rfkill list

#무선 통신을 비활성화 및 재활성화
sudo rfkill block all
sudo rfkill block <block_id>
sudo rfkill unblock <block_id>
```

### air
```shell
# 모니터 모드로 전환 wlan0 -> wlan0mon 으로 드라이버 명 변경됨.
sudo airmon-ng
sudo airmon-ng start wlan0

# 채널 스캔
# -c11 : channel / -w : log파일 
sudo airodump-ng wlan0mon -w ~/wifi/scan --mnufacturer --wps --band abg -c11

# s

```

## mdk
```shell
# AP-mac을 통한 ssid 유추 
mdk4 wlan0mon p -t F0:9F:C2:6A:88:26 -f ~/wifi-rockyou.txt

```

## WPA
```bash
# default credentials
network={
	ssid="$ESSID"
	key_mgmt=NONE
	scan_ssid=1
}
```

```shell
# wpa_supplicant 사용 전 충돌 방지 필수
sudo systemctl stop NetworkManager 
sudo systemctl disable NetworkManager

# network 연결 및 IP 할당 받기
wpa_supplicant -Dnl80211 -iwlan2 -c free.conf
dhclient wlan2 -v

# IP 할당 해제
dhclient wlan2 -r
```

# WireShark

## Local Capture
```shell
# Wi-Fi 어댑터를 모니터 모드로 설정
sudo ip link set wlan0 down
sudo iwconfig wlan0 mode monitor
sudo ip link set wlan0 up

# channel hop & quickly scan all channels on 2.4GHz
for channel in 1 6 11 2 7 10 3 8 4 9 5
do
  iw dev wlan0mon set channel ${channel}
  sleep 1
done
## channel hop 2
sudo airodump-ng wlan0mon

# all interface
sudo wireshark -D

# interface capture start & Monitor Mode & filter
sudo wireshark -i <interface> -k -I -f "<filter>" -s <byte length>

# pcap open
wireshark file.pcap
```

## Remote Capture
```shell
sudo tcpdump -U -w - -i wlan0mon | wireshark -k -i -
```

## Filtter
```wireshark
# 0, 1, 2, 3 -> 관리, 제어, 데이터, 확장 프레임
wlan.fc.type==2
!(wlan.fc.type == 1)

# 장치 필터링 & 비콘 & 프로브(요청 및 응답) & 연관성(요청 및 응답) & 데이터
((wlan addr1 3A:30:F9:0F:E1:95) or (wlan addr2 3A:30:F9:0F:E1:95) or (wlan addr3 3A:30:F9:0F:E1:95) or (wlan addr4 3A:30:F9:0F:E1:95)) and not (subtype beacon) and not (type ctl) and not (subtype probe-req) and not (subtype probe-resp)
```