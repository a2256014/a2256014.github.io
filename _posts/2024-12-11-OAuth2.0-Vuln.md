---
layout: post
title: OAuth2.0 Vuln
subtitle: OAuth2.0ì˜ ë‹¤ì–‘í•œ ìœ„í—˜ìš”ì†Œ
author: g3rm
categories: Web
banner:
  image: /assets/images/banners/home.gif
  opacity: 0.618
  background: "#000"
  heading_style: "font-size: 4.25em; font-weight: bold;"
  subheading_style: "color: gold"
tags:
  - OAuth2
  - Open_Redirect
  - CSRF
sidebar:
---
## Intro
OAuth 2.0ì€ ê¸°ì¡´ì— `ì•„ì´ë”” / ë¹„ë°€ë²ˆí˜¸`ë¡œ ë¡œê·¸ì¸í•˜ë˜ ì¸ì¦(ìê²© ì¦ëª…)ì„ íƒ€ ì„œë¹„ìŠ¤ì—ì„œë„ ì¸ì¦í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê¶Œí•œ ë¶€ì—¬ í”„ë ˆì„ì›Œí¬ ì…ë‹ˆë‹¤.   

ì˜ˆë¥¼ ë“¤ì–´, `Sign in with Google` ì²˜ëŸ¼ ìì‹ ì´ ë¡œê·¸ì¸í•˜ê³ ì í•˜ëŠ” ì„œë¹„ìŠ¤ëŠ” êµ¬ê¸€ì´ ì•„ë‹ˆì§€ë§Œ, êµ¬ê¸€ì´ ëŒ€ì‹  ìê²© ì¦ëª…ì„ í•´ì£¼ëŠ” ëŠë‚Œì…ë‹ˆë‹¤.  

ìš”ì¦˜ì€ ëŒ€ë¶€ë¶„ì˜ ì„œë¹„ìŠ¤ì—ì„œ OAuth ê¸°ëŠ¥ì„ ì œê³µí•˜ê³  ìˆì–´ ê·¸ë§Œí¼ ì·¨ì•½ì ì— ëŒ€í•œ ë³´ì•ˆ ì¡°ì¹˜ë“¤ì´ ì˜ ë˜ì–´ìˆì–´ ë°œê²¬ ê°€ëŠ¥ì„±ì€ ë‚®ì€ ê²ƒ ê°™ìŠµë‹ˆë‹¤.ğŸ˜‚   
## Detect & Exploit 
### Detect
ìš°ì„  OAuth ê¸°ëŠ¥ì´ ìˆëŠ” ê³³ì´ë©´ ì‹œë„í•´ë³¼ë§Œ í•©ë‹ˆë‹¤.    
### Exploit
PortSwiggerì— í•´ë‹¹ OAuthê´€ë ¨ ì¢‹ì€ ë¬¸ì œë“¤ì´ ìˆì–´ì„œ í•´ë‹¹ ë¬¸ì œ í’€ì´ë¡œ Exploitì„ ì ê² ìŠµë‹ˆë‹¤. - [PortSwigger OAuth 2.0 Lab](https://portswigger.net/web-security/oauth)   
#### Redirect URI
[Lab: OAuth account hijacking via redirect_uri](https://portswigger.net/web-security/oauth/lab-oauth-account-hijacking-via-redirect-uri)   

#### CSRF
[Lab: Forced OAuth profile linking](https://portswigger.net/web-security/oauth/lab-oauth-forced-oauth-profile-linking)   
Blog ê´€ë¦¬ì ê³„ì •ê³¼ Social ê³„ì •(OAuth)ì„ ì—°ë™í•´ì•¼í•˜ëŠ” ë¬¸ì œë¡œ OAuth í”„ë¡œì„¸ìŠ¤ ì¤‘ Social ê³„ì • ë¡œê·¸ì¸ í›„ **`Social ê³„ì • ì¸ê°€ Code`** ë¥¼ Blog ì„œë²„ì— ì „ë‹¬í•´ì£¼ëŠ” ê³¼ì •(ìœ ì €ì—ê²Œ 302 Redirectë¡œ ì „ë‹¬)ì´ ì¡´ì¬í•˜ëŠ” ë° í•´ë‹¹ ê³¼ì •ì—ì„œ ì·¨ì•½ì ì´ ë°œìƒí•œë‹¤.    
1. Social ê³„ì •ê³¼ ì—°ë™ ì‹œì‘   
	![](/assets/images/posts/2024-12-11-OAuth2.0-Vuln/64e0434a73f05a3febf5374f22619354_MD5.jpeg)   
2. Social ê³„ì • ë¡œê·¸ì¸ í›„ Blog ê³„ì •ê³¼ ì—°ë™ ì‹œì— í•„ì—°ì ìœ¼ë¡œ ì „ë‹¬í•´ì•¼ í•˜ëŠ” `code`íŒŒë¼ë¯¸í„°ë¥¼ ë‹´ì€ Redirect URI ë³µì‚¬ ë° í•´ë‹¹ íŒ¨í‚· Drop   
   *í•´ë‹¹ ë¶€ë¶„ì´ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ìœ¼ë¡œ Dropì˜ ì´ìœ ëŠ” `code`ê°€ ì¼íšŒì„±ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.   
	![](/assets/images/posts/2024-12-11-OAuth2.0-Vuln/a01e2ba1784acc9e9f4ac92b3bd0451d_MD5.jpeg)   
3. ë³µì‚¬í•œ URIë¥¼ í”¼í•´ìì—ê²Œ ì „ë‹¬      
	![](/assets/images/posts/2024-12-11-OAuth2.0-Vuln/60afb5e664a7e097ec7ad3b37f3f4117_MD5.jpeg)   
4. í”¼í•´ìê°€ í•´ë‹¹ URIì— ì ‘ê·¼í•  ì‹œ í”¼í•´ìì˜ Blog ê³„ì •ê³¼ ê³µê²©ìì˜ Social ê³„ì •ì´ ì„œë¡œ ì—°ë™ ë¨.   
	![](assets/images/posts/2024-12-11-OAuth2.0-Vuln/de4bc37e9a55f55a736371891ce6055f_MD5.jpeg)   
#### Etc
ê·¸ ì™¸ ë‹¤ì–‘í•œ ë°©ë²•ì´ PortSwigger Labì— ìˆëŠ”ë°, 

## Security Measures
   
## References
[OAuth 2.0 - Security and Vulnerabilities](https://medium.com/@ibm_ptc_security/oauth-2-0-security-and-vulnerabilities-86e64c22b03d)   